---
  title: 模块加载
---


# 模块加载

## 1. 模块类型

- 核心模块
- 其他模块: 第三方模块, 自己写的本地模块

## 2. 加载方式

**2.1 核心模块**

```js
require('http');
```

- 只能通过模块名称引用, 而不是文件路径
- 同名模块会优先加载核心模块
- 在线程启动时被载入

**2.2 其他模块**

1. 路径格式的文件模块

```js
// 绝对路径
require('/abc/aa');

// 相对路径
require('./abc/aa');
```

> 如果是文件夹, node会假设其是一个程序包, 则会按照如下规则查找
>
> 1. 查找该文件夹下 package.json 下 `main` 字段下指定的文件, 如果没有 package.json,则
> 2. 查找该目录下 index.js 的文件. (默认包的入口是: index.js)

> 注:
> 在加载 相对路径 模块时, node 会解析出一个绝对路径.

2. 非路径格式的文件模块

如果模块名不是 路径或核心模块. 那么会从 `node_modules` 里面找:

- 从当前目录的 `node_modules` 文件夹里面找
- 如果当前目录没有 `node_modules`, 逐级往上直到根目录或找到为止.

> 注:
> 在加载 `node_modules` 里的模块时, node 会解析出一个绝对路径.

## 3. 缓存

第一次引入模块会把模块初始化(运行)一次, 接着模块会被缓存起来.

模块被缓存起来后, 再次引入同名模块不再执行模块内容, 直接从缓存返回.
